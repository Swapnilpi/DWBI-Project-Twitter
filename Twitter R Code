library(twitteR)
library(purrr)
library(dplyr)
require(RCurl)
require(ROAuth)
library(plyr)
library(stringr)


list.pos.words <- scan("C:/Users/arjit Bhai/Documents/pos_words.txt",what = 'character',comment.char = ";")
#print(list.pos.words)
class(list.pos.words)
list.pos.words <- scan("C:/Users/arjit Bhai/Documents/pos_words.txt",what = 'character',comment.char = "")
list.neg.words <- scan("C:/Users/arjit Bhai/Documents/neg_words.txt",what = 'character',comment.char = "")
#print(list.neg.words)


score.sentiments <- function(sentence,list.pos.words,list.neg.words){

#sentence <- "this is despise worst sad and lag and it can improve as well bad last"
sentence <- gsub('[[:punct:]]',"",sentence)
sentence <- gsub('[[:cntrl:]]',"",sentence)
sentence <- gsub('\\d+',"",sentence)
sentence <- tolower(sentence)
#print(sentence)
word.list <- strsplit(sentence,"\\s+")
#print(word.list)
words <- unlist(word.list,list)
#print(words)

pos.matches <- match(words,list.pos.words)

#print(pos.matches)
is.pos.matches <- sum(!is.na(pos.matches))
#print(is.pos.matches)


neg.matches <- match(words,list.neg.words)
#print(neg.matches)
is.neg.matches <- sum(!is.na(neg.matches))
#print(is.neg.matches)

scores <- is.pos.matches - is.neg.matches
return(scores)
}





#twitter settings
consumerKey <- 'vvj2iO41GSoYpZ0zYxq2viJGc'
reqURL <- 'https://api.twitter.com/oauth/request_token'
accessURL <- 'https://api.twitter.com/oauth/access_token'
authURL <- 'https://api.twitter.com/oauth/authorize'
consumerSecret <- 'yNPvb8haQDF6JPeoywrHhROX8Zuo2pAehrttUkSXQxeuwEs4gT'
accessToken <- '978371128778510338-zWPwAxMoDGzwbvHwYVoT3jf51xhyieq'
accessTokenSecret <- 'Q4hSbE5Sxpj18LRGnu47BTbloRmfbazAYwXV1I0YTjPDh'

twitCred <- OAuthFactory$new(consumerKey =consumerKey,
                             consumerSecret=consumerSecret,
                             requestURL= reqURL,
                             accessURL =accessURL,
                             authURL =authURL)
twitCred$handshake()

setup_twitter_oauth(consumerKey,consumerSecret,accessToken,accessTokenSecret)

tweet<- userTimeline("@UNEnvironment",n=100)
tweet_df <- tbl_df(map_df(tweet,as.data.frame))
final <- lapply(tweet_df$text,score.sentiments,list.pos.words=list.pos.words,list.neg.words=list.neg.words)
final <- unlist(final,list)


make_df <- data.frame(a=tweet_df$text,b=final)

write.csv(make_df , file = "sample7.csv")





  

